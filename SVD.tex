% -*- root: Main.tex -*-
\section{SVD}
$\mathbf{A} = \mathbf{U} \mathbf{D} \mathbf{V}^\top = \sum_{k=1}^{\operatorname{rank}(\mathbf{A})} d_{k,k} u_k (v_k)^\top$\\
$\mathbf{A} \in \mathbb{R}^{N \times P}, \mathbf{U} \in \mathbb{R}^{N \times N}, \mathbf{D} \in \mathbb{R}^{N \times P}, \mathbf{V} \in \mathbb{R}^{P \times P}$\\
$\mathbf{U}^\top \mathbf{U} = I = \mathbf{V}^\top \mathbf{V}$ ($\mathbf{U}, \mathbf{V}$orthonormal)\\
$\mathbf{U}$ columns are eigenvectors of $\mathbf{A} \mathbf{A}^\top$, $\mathbf{V}$ columns are eigenvectors of $\mathbf{A}^\top \mathbf{A}$, $\mathbf{D}$ diagonal elements are singular values.\\
$(\mathbf{D}^{-1})_{i,i} = \frac{1}{\mathbf{D}_{i, i}}$ (don't forget to transpose)

\begin{inparaenum}[\color{red}1.]
	\item calc $\mathbf{A}^\top \mathbf{A}$.
	\item calc EVs of $\mathbf{A}^\top \mathbf{A}$, the $\sqrt{}$ in desc. order are diag. of $\mathbf{D}$.
	\item calc eigenvecs of $\mathbf{A}^\top \mathbf{A}$ using EVs resulting in cols of $\mathbf{V}$.
    \item calc missing matrix: $\mathbf{U} = \mathbf{A} \mathbf{V} \mathbf{D}^{-1}$
	\item normalize each col of $\mathbf{U}$ and $\mathbf{V}$.
\end{inparaenum}

Nb nonzero singular vals = rank(A). First r cols of U basis of C(A), last n - r cols of V basis of N(A). 
$\lambda_i = \sigma_i^2$ for square symmetric matrix A.

SVD construction: $v_i = arg max_w ||Bw|| = \sigma_i $, s.t. $||w|| = 1$, $u_i = \frac{1}{\sigma_i} B_i v_i$. $B_0 = A, B_{i+1} = B_i - \sigma_i u_i v_i^T$


\subsection*{Low-Rank approximation}
Using only $K$ largest eigenvalues and corresponding eigenvectors. $\tilde{\mathbf{A}}_{i, j} = \sum_{k=1}^K \mathbf{U}_{i, k} \mathbf{D}_{k,k} \mathbf{V}_{j, k} = \sum_{k=1}^K \mathbf{U}_{i, k} \mathbf{D}_{k,k} (\mathbf{V}^\top)_{k, j}$.

\subsection*{Eckart-Young Theorem}
$\min_{rank(B)=K} ||A-B||_F^2 = ||A-A_k||_F^2 = \sum_{r=k+1}^{rank(A)} \sigma_r^2$
$\min_{rank(B)=K} ||A-B||_2 = ||A-A_k||_2 = \sigma_{k+1}$

